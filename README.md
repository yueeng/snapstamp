# Water - 照片日期水印工具

这是一个 Go 命令行工具，用来读取照片 EXIF 的拍摄日期并把日期作为水印绘制到图片右下角。目标是做一个简单、可批量运行的工具，保留原图目录结构并输出带水印的文件。

构建

  go build

主要功能

- 读取 EXIF 中 DateTimeOriginal / DateTime，若缺失则回退到文件修改时间。
- 支持单文件或目录批量处理（支持保留相对目录结构的输出目录）。
- 支持指定 TTF 字体（或只传字体文件名，程序会在系统字体目录尝试查找）。
- 字体大小按图片宽度百分比自动缩放以适配水印宽度（`-widthpercent`）。

使用示例

- 单张图片（默认输出为原名 + `_watermarked`）：
  go run . -in photo.jpg

- 指定输出路径（单文件）：
  go run . -in photo.jpg -out out.jpg

- 批量处理目录并将结果写入输出目录（保留相对结构）：
  go run . -in ./SRC -out ./DST


可用参数（重要）

- -in string (必需)：输入文件或目录（支持 JPG/JPEG/PNG）。默认 `.`。
- -out string：输出文件或目录。可为单一输出文件路径（单文件模式），也可为目标目录（若为目录，程序在目录下写入处理后的文件并保留输入的相对路径）。默认 `.`。
- -margin int：水印与图片边缘的像素间距，默认 `12`。
- -recursive bool：当 `-in` 为目录时是否递归遍历子目录，默认 `false`。
- -font string：TTF 字体文件路径或字体文件名（例如 `arial.ttf`）。若只提供文件名，程序会在常见系统字体目录（Windows: C:\\Windows\\Fonts，macOS/Linux 的标准目录）尝试查找该文件；若加载失败，会回退到内置位图字体 `basicfont.Face7x13`。
- -widthpercent int：水印最大宽度占图片宽度的百分比（1-100），默认值在 `main.go` 中为 `25`（即 25%）。


注意

- 当程序从 EXIF 中读取到的时间字段格式为常见 EXIF 形式（如 `2006:01:02 15:04:05`）时，会把年月日中的冒号替换为短横以便更易读（变为 `2006-01-02 15:04:05`）。
- 文本换行：程序会尝试按空格贪婪换行，若单个词过长则按字符拆分以保证每行不超出指定宽度。
- 阴影与颜色：当前实现会在白色主文字下绘制一个黑色阴影（在 `main.go` 中通过偏移 5 像素实现）。
- 输出格式：若输入为 PNG，则输出为 PNG；其它格式（常见 JPEG）按 JPEG 输出，质量设置为 95。
- 如果你希望我从代码中移除或添加额外参数（例如背景块、阴影颜色可选项等），请说明，我可以同步修改 `main.go` 并重新编译/测试。

如果你希望我加入或移除其它参数（例如背景块、阴影颜色等），请明确说明要保留或删除的选项，我会按此更新代码与文档。
